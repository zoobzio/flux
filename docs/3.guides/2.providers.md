---
title: Providers
description: Overview of all flux data source providers
author: zoobzio
published: 2025-12-11
updated: 2025-12-11
tags:
  - Providers
  - Watchers
  - Data Sources
---

# Providers

Flux providers live in `pkg/` with isolated dependencies. Each implements the `Watcher` interface for a specific backend.

## Installation

Install only the providers you need:

```bash
go get github.com/zoobzio/flux/pkg/file
go get github.com/zoobzio/flux/pkg/redis
go get github.com/zoobzio/flux/pkg/consul
# etc.
```

## Provider Overview

| Provider | Backend | Watch Mechanism | Use Case |
|----------|---------|-----------------|----------|
| `pkg/file` | Local FS | fsnotify | Local config files |
| `pkg/redis` | Redis | Keyspace notifications | Shared config, feature flags |
| `pkg/consul` | Consul KV | Blocking queries | Service configuration |
| `pkg/etcd` | etcd | Watch API | Distributed config |
| `pkg/postgres` | PostgreSQL | LISTEN/NOTIFY | Database-backed config |
| `pkg/nats` | NATS JetStream | KV Watch | Cloud-native messaging |
| `pkg/kubernetes` | ConfigMap/Secret | Watch API | K8s-native apps |
| `pkg/zookeeper` | ZooKeeper | Node watch | Legacy systems |
| `pkg/firestore` | Firestore | Realtime listeners | GCP applications |

## File

Watch local filesystem files using fsnotify.

```go
import "github.com/zoobzio/flux/pkg/file"

capacitor := flux.New[Config](
    file.New("/etc/myapp/config.json"),
    callback,
)
```

**Best for:** Local development, single-instance deployments, config files managed by CM tools.

## Redis

Watch Redis keys using keyspace notifications.

```go
import (
    "github.com/redis/go-redis/v9"
    fluxredis "github.com/zoobzio/flux/pkg/redis"
)

client := redis.NewClient(&redis.Options{Addr: "localhost:6379"})

capacitor := flux.New[Config](
    fluxredis.New(client, "myapp:config"),
    callback,
)
```

**Requires** keyspace notifications enabled:

```bash
redis-cli CONFIG SET notify-keyspace-events KEA
```

**Best for:** Feature flags, shared configuration across instances.

## Consul

Watch Consul KV using blocking queries.

```go
import (
    "github.com/hashicorp/consul/api"
    fluxconsul "github.com/zoobzio/flux/pkg/consul"
)

client, _ := api.NewClient(api.DefaultConfig())

capacitor := flux.New[Config](
    fluxconsul.New(client, "myapp/config"),
    callback,
)
```

**Best for:** HashiCorp ecosystem, service mesh configurations.

## etcd

Watch etcd keys using the native Watch API.

```go
import (
    clientv3 "go.etcd.io/etcd/client/v3"
    fluxetcd "github.com/zoobzio/flux/pkg/etcd"
)

client, _ := clientv3.New(clientv3.Config{
    Endpoints: []string{"localhost:2379"},
})

capacitor := flux.New[Config](
    fluxetcd.New(client, "/myapp/config"),
    callback,
)
```

**Best for:** Kubernetes ecosystem, distributed systems requiring strong consistency.

## PostgreSQL

Watch configuration using LISTEN/NOTIFY.

```go
import (
    "github.com/jackc/pgx/v5/pgxpool"
    fluxpg "github.com/zoobzio/flux/pkg/postgres"
)

pool, _ := pgxpool.New(ctx, "postgres://localhost/myapp")

capacitor := flux.New[Config](
    fluxpg.New(pool, "config_changes", "myapp",
        fluxpg.WithTable("config"),
        fluxpg.WithKeyColumn("key"),
        fluxpg.WithValueColumn("value"),
    ),
    callback,
)
```

**Requires** a trigger to NOTIFY on changes. See pkg/postgres/README.md.

**Best for:** Apps already using PostgreSQL, config versioning requirements.

## NATS

Watch NATS JetStream KV buckets.

```go
import (
    "github.com/nats-io/nats.go"
    "github.com/nats-io/nats.go/jetstream"
    fluxnats "github.com/zoobzio/flux/pkg/nats"
)

nc, _ := nats.Connect("nats://localhost:4222")
js, _ := jetstream.New(nc)
kv, _ := js.KeyValue(ctx, "config")

capacitor := flux.New[Config](
    fluxnats.New(kv, "myapp"),
    callback,
)
```

**Best for:** Cloud-native apps, microservices using NATS for messaging.

## Kubernetes

Watch ConfigMaps or Secrets.

```go
import (
    "k8s.io/client-go/kubernetes"
    "k8s.io/client-go/rest"
    fluxk8s "github.com/zoobzio/flux/pkg/kubernetes"
)

config, _ := rest.InClusterConfig()
client, _ := kubernetes.NewForConfig(config)

// ConfigMap (default)
capacitor := flux.New[Config](
    fluxk8s.New(client, "default", "myapp-config", "config.json"),
    callback,
)

// Secret
capacitor := flux.New[Config](
    fluxk8s.New(client, "default", "myapp-secret", "config.json",
        fluxk8s.WithResourceType(fluxk8s.Secret),
    ),
    callback,
)
```

**Best for:** Kubernetes-native applications, GitOps workflows.

## ZooKeeper

Watch ZooKeeper nodes.

```go
import (
    "github.com/go-zookeeper/zk"
    fluxzk "github.com/zoobzio/flux/pkg/zookeeper"
)

conn, _, _ := zk.Connect([]string{"localhost:2181"}, 5*time.Second)

capacitor := flux.New[Config](
    fluxzk.New(conn, "/config/myapp"),
    callback,
)
```

**Best for:** Legacy systems, Kafka ecosystem, existing ZK infrastructure.

## Firestore

Watch Firestore documents using realtime listeners.

```go
import (
    "cloud.google.com/go/firestore"
    fluxfs "github.com/zoobzio/flux/pkg/firestore"
)

client, _ := firestore.NewClient(ctx, "my-project")

capacitor := flux.New[Config](
    fluxfs.New(client, "config", "myapp"),
    callback,
)
```

**Document structure:** By default expects a `data` field containing JSON:

```json
{"data": "{\"port\": 8080}"}
```

Use helper functions:
```go
fluxfs.CreateDocument(ctx, client, "config", "myapp", []byte(`{"port": 8080}`))
fluxfs.UpdateDocument(ctx, client, "config", "myapp", []byte(`{"port": 9090}`))
```

**Best for:** GCP applications, serverless deployments on Cloud Run/Functions.

## Choosing a Provider

| Requirement | Recommended |
|-------------|-------------|
| Simple, single instance | file |
| Shared across instances | redis, consul, etcd |
| Already using PostgreSQL | postgres |
| Kubernetes-native | kubernetes |
| GCP/Firebase | firestore |
| NATS messaging | nats |
| Existing ZK infrastructure | zookeeper |

## Next Steps

- [Custom Watcher](../4.cookbook/3.custom-watcher.md) - Build your own provider
- [Multi-Source](../4.cookbook/2.multi-source.md) - Combine multiple providers
