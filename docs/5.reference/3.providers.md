---
title: Providers Reference
description: API reference for all flux provider packages
author: zoobzio
published: 2025-12-11
updated: 2025-12-11
tags:
  - Reference
  - Providers
  - API
---

# Providers Reference

API reference for all provider packages in `github.com/zoobzio/flux/pkg/`.

## pkg/file

File watcher using fsnotify.

```go
import "github.com/zoobzio/flux/pkg/file"
```

### New

```go
func New(path string, opts ...Option) *Watcher
```

Creates a watcher for the given file path.

### Options

None currently defined.

### Example

```go
capacitor := flux.New[Config](
    file.New("/etc/myapp/config.json"),
    callback,
)
```

---

## pkg/redis

Redis watcher using keyspace notifications.

```go
import "github.com/zoobzio/flux/pkg/redis"
```

### New

```go
func New(client *redis.Client, key string, opts ...Option) *Watcher
```

Creates a watcher for the given Redis key.

**Requires** keyspace notifications enabled:
```bash
redis-cli CONFIG SET notify-keyspace-events KEA
```

### Options

None currently defined.

### Example

```go
client := redis.NewClient(&redis.Options{Addr: "localhost:6379"})

capacitor := flux.New[Config](
    fluxredis.New(client, "myapp:config"),
    callback,
)
```

---

## pkg/consul

Consul KV watcher using blocking queries.

```go
import "github.com/zoobzio/flux/pkg/consul"
```

### New

```go
func New(client *api.Client, key string, opts ...Option) *Watcher
```

Creates a watcher for the given Consul KV key.

### Options

None currently defined.

### Example

```go
client, _ := api.NewClient(api.DefaultConfig())

capacitor := flux.New[Config](
    consul.New(client, "myapp/config"),
    callback,
)
```

---

## pkg/etcd

etcd watcher using the native Watch API.

```go
import "github.com/zoobzio/flux/pkg/etcd"
```

### New

```go
func New(client *clientv3.Client, key string, opts ...Option) *Watcher
```

Creates a watcher for the given etcd key.

### Options

None currently defined.

### Example

```go
client, _ := clientv3.New(clientv3.Config{
    Endpoints: []string{"localhost:2379"},
})

capacitor := flux.New[Config](
    etcd.New(client, "/myapp/config"),
    callback,
)
```

---

## pkg/postgres

PostgreSQL watcher using LISTEN/NOTIFY.

```go
import "github.com/zoobzio/flux/pkg/postgres"
```

### New

```go
func New(pool *pgxpool.Pool, channel, key string, opts ...Option) *Watcher
```

Creates a watcher that listens on the given PostgreSQL channel and filters by key.

### Options

#### WithTable

```go
func WithTable(table string) Option
```

Sets the table name. Default: `"config"`.

#### WithKeyColumn

```go
func WithKeyColumn(column string) Option
```

Sets the key column name. Default: `"key"`.

#### WithValueColumn

```go
func WithValueColumn(column string) Option
```

Sets the value column name. Default: `"value"`.

### Example

```go
pool, _ := pgxpool.New(ctx, "postgres://localhost/myapp")

capacitor := flux.New[Config](
    postgres.New(pool, "config_changes", "myapp",
        postgres.WithTable("app_config"),
        postgres.WithKeyColumn("config_key"),
        postgres.WithValueColumn("config_value"),
    ),
    callback,
)
```

**Requires** a trigger to NOTIFY on changes. See pkg/postgres/README.md for schema.

---

## pkg/nats

NATS JetStream KV watcher.

```go
import "github.com/zoobzio/flux/pkg/nats"
```

### New

```go
func New(kv jetstream.KeyValue, key string, opts ...Option) *Watcher
```

Creates a watcher for the given NATS KV key.

### Options

None currently defined.

### Example

```go
nc, _ := nats.Connect("nats://localhost:4222")
js, _ := jetstream.New(nc)
kv, _ := js.KeyValue(ctx, "config")

capacitor := flux.New[Config](
    fluxnats.New(kv, "myapp"),
    callback,
)
```

---

## pkg/kubernetes

Kubernetes ConfigMap/Secret watcher.

```go
import "github.com/zoobzio/flux/pkg/kubernetes"
```

### New

```go
func New(client kubernetes.Interface, namespace, name, key string, opts ...Option) *Watcher
```

Creates a watcher for a ConfigMap or Secret. The `key` specifies which data key within the resource to watch.

### ResourceType

```go
type ResourceType int

const (
    ConfigMap ResourceType = iota
    Secret
)
```

### Options

#### WithResourceType

```go
func WithResourceType(rt ResourceType) Option
```

Sets the resource type. Default: `ConfigMap`.

### Example

```go
config, _ := rest.InClusterConfig()
client, _ := kubernetes.NewForConfig(config)

// ConfigMap
capacitor := flux.New[Config](
    k8s.New(client, "default", "myapp-config", "config.json"),
    callback,
)

// Secret
capacitor := flux.New[Config](
    k8s.New(client, "default", "myapp-secret", "config.json",
        k8s.WithResourceType(k8s.Secret),
    ),
    callback,
)
```

---

## pkg/zookeeper

ZooKeeper node watcher.

```go
import "github.com/zoobzio/flux/pkg/zookeeper"
```

### New

```go
func New(conn *zk.Conn, path string, opts ...Option) *Watcher
```

Creates a watcher for the given ZooKeeper node path.

### Options

None currently defined.

### Example

```go
conn, _, _ := zk.Connect([]string{"localhost:2181"}, 5*time.Second)

capacitor := flux.New[Config](
    zookeeper.New(conn, "/config/myapp"),
    callback,
)
```

---

## pkg/firestore

Firestore document watcher using realtime listeners.

```go
import "github.com/zoobzio/flux/pkg/firestore"
```

### New

```go
func New(client *firestore.Client, collection, document string, opts ...Option) *Watcher
```

Creates a watcher for the given Firestore document.

### Options

#### WithField

```go
func WithField(field string) Option
```

Sets a specific field to extract. Default: extracts `"data"` field.

### Helper Functions

#### CreateDocument

```go
func CreateDocument(ctx context.Context, client *firestore.Client, collection, document string, data []byte) error
```

Creates a document with the expected structure.

#### UpdateDocument

```go
func UpdateDocument(ctx context.Context, client *firestore.Client, collection, document string, data []byte) error
```

Updates a document's data field.

### Example

```go
client, _ := firestore.NewClient(ctx, "my-project")

capacitor := flux.New[Config](
    fluxfs.New(client, "config", "myapp"),
    callback,
)

// Or with specific field
capacitor := flux.New[Config](
    fluxfs.New(client, "config", "myapp", fluxfs.WithField("settings")),
    callback,
)
```

**Document structure:** By default expects a `data` field:
```json
{"data": "{\"port\": 8080}"}
```

---

## Common Patterns

All providers implement the same interface:

```go
type Watcher interface {
    Watch(ctx context.Context) (<-chan []byte, error)
}
```

All providers:
- Emit current value immediately on `Watch()`
- Emit subsequent values on change
- Close channel when context is cancelled
- Return error if watching cannot start

## Next Steps

- [Providers Guide](../3.guides/2.providers.md) - Usage guidance
- [Custom Watcher](../4.cookbook/3.custom-watcher.md) - Build your own
